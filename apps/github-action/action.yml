name: "LazyPR AI PR Summary"

description: "Generates AI-powered PR summaries with Ghost Commit detection, impact scoring, and automated reviewer checklists"
author: "elvis-ndubuisi"

inputs:
  api_key:
    description: "API key for your LLM provider (OpenAI, Anthropic, or Google Gemini)"
    required: true
  provider:
    description: "LLM provider to use (openai, anthropic, or gemini)"
    required: false
    default: "openai"
  model:
    description: "Model to use (defaults to provider-specific model if not specified)"
    required: false
    default: ""
  template:
    description: "Built-in prompt preset to use (default, concise, verbose, security-focused). Ignored if a valid custom template is found."
    required: false
    default: "default"
  custom_template:
    description: "Whether to load a custom template from the repository (true/false)"
    required: false
    default: "true"
  custom_template_path:
    description: "Optional explicit path to a custom template file in the repo (e.g. .github/lazypr-template.md)"
    required: false
    default: ""
  ticket_pattern:
    description: "Custom regex pattern for detecting ticket IDs (e.g. [A-Z]+-\\d+ for JIRA style)"
    required: false
    default: ""
  ticket_url_template:
    description: "URL template for ticket links. Use {{id}} placeholder (e.g. https://jira.example.com/browse/{{id}})"
    required: false
    default: ""
  auto_update_title:
    description: "Automatically update vague PR titles. Only updates if enabled."
    required: false
    default: "false"
  vagueness_threshold:
    description: "Vagueness score (0-100) that triggers auto-rename. Lower = more aggressive. Default: 40 (catches lazy titles like 'fixes', 'updates')"
    required: false
    default: "40"
  custom_placeholders:
    description: "JSON object of custom placeholders to substitute in templates (e.g. {\"{{qaNotes}}\": \"Tested on staging\"})"
    required: false
    default: "{}"
  pr_size_warning:
    description: "Warn if PR exceeds this many lines (0 to disable). Default: 500"
    required: false
    default: "500"
  pr_size_block:
    description: "Block summarization if PR exceeds this many lines (0 to disable). Default: 2000"
    required: false
    default: "2000"
  github_token:
    description: "GitHub token for API access (automatically provided by GitHub Actions)"
    required: true

outputs:
  summary:
    description: "Generated PR summary"
  has_ghost_commits:
    description: "Whether ghost commits were detected"
  risk_level:
    description: "Risk level of the PR changes (LOW, MEDIUM, or HIGH)"
  impact_score:
    description: "Impact score from 0-100"
  related_tickets:
    description: "Markdown-formatted list of detected related tickets (JIRA, GitHub issues, etc.)"
  enhanced_title:
    description: "Improved PR title if original was vague, empty if no change needed"
  custom_placeholders_applied:
    description: "Number of custom placeholders that were substituted in the template"
  pr_size_lines:
    description: "Total number of lines changed in the PR"
  pr_size_warning_triggered:
    description: "Whether the PR size warning was triggered (true/false)"
  pr_size_blocked:
    description: "Whether summarization was blocked due to PR size (true/false)"

runs:
  using: "node20"
  main: "dist/index.js"

branding:
  icon: "git-pull-request"
  color: "purple"
